<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Smotrilka</title>
    <link rel="stylesheet" href="~/css/dark-theme.css" />
    <link rel="stylesheet" href="~/css/site.css" />
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <a href="/" class="nav-link brand-link">Smotrilka</a>
            </div>

            <div class="nav-links">
                <a href="/" class="nav-link">Поиск</a>

                @if (IsUserAuthenticated())
                {
                    <a href="/AddLink" class="nav-link">Добавить ссылку</a>
                    <a href="/Favorites" class="nav-link">Избранное</a>

                    <button type="submit" class="nav-link btn-logout" onclick="redirectToPage()">Выйти</button>
                    <script>
                        function redirectToPage() {
                            window.location.href = "http://localhost:10000/Logout";
                        }
                    </script>
                    <span class="user-greeting">Привет, @GetUserName()!</span>
                }
                else
                {
                    <a href="/Login" class="nav-link">Войти</a>
                    <a href="/Register" class="nav-link">Регистрация</a>
                }
            </div>
        </div>
    </nav>

    <main>
        @RenderBody()
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Smotrilka - Платформа для образовательных материалов</p>
        </div>
    </footer>

    <script src="~/js/site.js"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>

@functions {
    private bool IsUserAuthenticated()
    {
        return Context.Request.Cookies.ContainsKey("userLogin");
    }

    private string GetUserName()
    {
        return Context.Request.Cookies["userLogin"] ?? "Пользователь";
    }
}